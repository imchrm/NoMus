# NoMus

**Telegram-ะฑะพั ะดะปั ะทะฐะบะฐะทะฐ ััะปัะณ ะฝะฐัะตะปะตะฝะธั**

NoMus โ ััะพ Telegram-ะฑะพั ะฝะฐ ะฑะฐะทะต aiogram 3.x, ะธะฝัะตะณัะธัะพะฒะฐะฝะฝัะน ั backend-ัะธััะตะผะพะน NMservices ะดะปั ะพะฑัะฐะฑะพัะบะธ ัะตะณะธัััะฐัะธะธ ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะธ ัะพะทะดะฐะฝะธั ะทะฐะบะฐะทะพะฒ.

---

## ๐๏ธ ะััะธัะตะบัััะฐ

### ะะพะผะฟะพะฝะตะฝัั ัะบะพัะธััะตะผั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ NoMus Bot (Telegram)                 โ
โ  โโ MemoryStorage (FSM cache)        โ โ ะัะตะผะตะฝะฝัะน ะบะตั ะดะปั ัะตะณะธัััะฐัะธะธ
โ  โโ RemoteApiClient                  โ โ HTTP ะบะปะธะตะฝั ะดะปั NMservices
โ     โโ POST /users/register          โ
โ     โโ POST /orders                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ HTTP POST
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ NMservices (Backend)                 โ
โ  โโ FastAPI + uvicorn                โ
โ  โโ PostgreSQL Database              โ โ ะัะฝะพะฒะฝะฐั ะฑะฐะทะฐ ะดะฐะฝะฝัั
โ     โโ users table                   โ
โ     โโ orders table                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ะะปััะตะฒัะต ะพัะพะฑะตะฝะฝะพััะธ

- **NoMus Bot** - Telegram-ะฑะพั (aiogram 3.x) ะดะปั ะฒะทะฐะธะผะพะดะตะนััะฒะธั ั ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ
- **NMservices** - Backend ัะตัะฒะตั (FastAPI + PostgreSQL) ะดะปั ะพะฑัะฐะฑะพัะบะธ ะดะฐะฝะฝัั
- **MemoryStorage** - ะะพะบะฐะปัะฝัะน ะบะตั ะดะปั FSM states ะธ ะฟัะพะผะตะถััะพัะฝัั ะดะฐะฝะฝัั ัะตะณะธัััะฐัะธะธ
- **RemoteApiClient** - HTTP ะบะปะธะตะฝั ะดะปั ะธะฝัะตะณัะฐัะธะธ ั NMservices API

**ะะฐะถะฝะพ**: ะะพั **ะะ ะฟะพะดะบะปััะฐะตััั ะบ PostgreSQL ะฝะฐะฟััะผัั**. ะัั ัะฐะฑะพัะฐ ั ะฑะฐะทะพะน ะดะฐะฝะฝัั ะฟัะพะธััะพะดะธั ัะตัะตะท REST API NMservices.

---

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
NoMus/
โโโ config/
โ   โโโ environments/          # ะะพะฝัะธะณััะฐัะธะธ ะพะบััะถะตะฝะธะน
โ   โ   โโโ development.yaml
โ   โ   โโโ development-remote.yaml
โ   โ   โโโ staging.yaml
โ   โ   โโโ production.yaml
โ   โโโ localization/          # ะะพะบะฐะปะธะทะฐัะธั (ru, uz, en)
โ       โโโ messages.yaml
โ
โโโ docs/                      # ะะพะบัะผะตะฝัะฐัะธั
โ   โโโ bot_flow.md           # ะะตัะฐะปัะฝัะน ะฟะพัะพะบ ัะฐะฑะพัั ะฑะพัะฐ
โ   โโโ DDD_Analysis.md       # ะะฝะฐะปะธะท DDD ะฐััะธัะตะบัััั
โ   โโโ QUICKSTART_DB_TESTING.md  # ะัััััะน ััะฐัั ะดะปั ะพัะปะฐะดะบะธ
โ   โโโ TEST_RESULTS.md       # ะะตะทัะปััะฐัั ัะตััะธัะพะฒะฐะฝะธั API
โ
โโโ scripts/                   # ะกะบัะธะฟัั ะทะฐะฟััะบะฐ
โ
โโโ src/nomus/                 # ะัะฝะพะฒะฝะพะน ะบะพะด
โ   โโโ main.py               # ะขะพัะบะฐ ะฒัะพะดะฐ
โ   โโโ config/               # ะะพะฝัะธะณััะฐัะธั
โ   โโโ domain/               # ะะพะผะตะฝะฝัะน ัะปะพะน (entities, interfaces)
โ   โโโ application/          # ะะธะทะฝะตั-ะปะพะณะธะบะฐ (services)
โ   โโโ infrastructure/       # ะะฝะตัะฝะธะต ัะตัะฒะธัั (API, DB)
โ   โโโ presentation/         # Telegram bot handlers
โ
โโโ tests/                     # ะขะตััั
โ   โโโ manual/               # ะััะฝัะต ัะตััั
โ   โ   โโโ test_api_connection.py
โ   โ   โโโ test_env_check.py
โ   โ   โโโ test_settings_load.py
โ   โโโ ...                   # ะฎะฝะธั-ัะตััั
โ
โโโ .env.example              # ะจะฐะฑะปะพะฝ ะบะพะฝัะธะณััะฐัะธะธ
โโโ pyproject.toml            # ะะฐะฒะธัะธะผะพััะธ (Poetry)
โโโ CLAUDE.md                 # ะะพะปะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั ะดะปั ัะฐะทัะฐะฑะพัะบะธ
```

---

## ๐ ะัััััะน ััะฐัั

### 1. ะะปะพะฝะธัะพะฒะฐะฝะธะต ัะตะฟะพะทะธัะพัะธั

```bash
git clone https://github.com/imchrm/NoMus.git
cd NoMus
```

### 2. ะฃััะฐะฝะพะฒะบะฐ Poetry

ะัะธัะธะฐะปัะฝัะน [ะณะฐะนะด ะฟะพ ัััะฐะฝะพะฒะบะต](https://python-poetry.org/docs/#installation).

### 3. ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน

```bash
# ะะฐัััะพะนะบะฐ ะฒะธัััะฐะปัะฝะพะณะพ ะพะบััะถะตะฝะธั ะฒะฝัััะธ ะฟัะพะตะบัะฐ
poetry config virtualenvs.in-project true

# ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน
poetry install
```

### 4. ะะฐัััะพะนะบะฐ ะพะบััะถะตะฝะธั

1. ะกะบะพะฟะธััะนัะต `.env.example` ะฒ `.env`:
```bash
cp .env.example .env
```

2. ะััะตะดะฐะบัะธััะนัะต `.env`:
```bash
# ะัะฑะพั ะพะบััะถะตะฝะธั
ENV=development-remote

# ะขะพะบะตะฝ Telegram ะฑะพัะฐ (ะฟะพะปััะธัั ั @BotFather)
BOT_TOKEN=your_bot_token_here

# NMservices API (ะฐะดัะตั backend ัะตัะฒะตัะฐ)
REMOTE_API_BASE_URL=http://192.168.1.191:8000
REMOTE_API_KEY=your_api_key_here

# ะะฟัะธะพะฝะฐะปัะฝะพ: ะฟัะพะฟััะบ ัะตะณะธัััะฐัะธะธ ะดะปั ะฑััััะพะณะพ ัะตััะธัะพะฒะฐะฝะธั
SKIP_REGISTRATION=False
```

### 5. ะะฐะฟััะบ ะฑะพัะฐ

```bash
# Development ั ะปะพะบะฐะปัะฝัะผะธ stub-ัะตัะฒะธัะฐะผะธ
ENV=development poetry run python -m nomus.main

# Development ั ัะดะฐะปัะฝะฝัะผ NMservices API
ENV=development-remote poetry run python -m nomus.main

# Production
ENV=production poetry run python -m nomus.main
```

---

## ๐ ะะบััะถะตะฝะธั

ะัะพะตะบั ะฟะพะดะดะตัะถะธะฒะฐะตั ะฝะตัะบะพะปัะบะพ ัะตะถะธะผะพะฒ ัะฐะฑะพัั:

### `development` - ะะพะบะฐะปัะฝะฐั ัะฐะทัะฐะฑะพัะบะฐ
- **Database**: MemoryStorage (in-memory ะบะตั)
- **SMS**: Stub (ะปะพะณะธ ะฒ ะบะพะฝัะพะปั, ัะธะบัะธัะพะฒะฐะฝะฝัะน ะบะพะด `1234`)
- **Payment**: Stub (ะผะณะฝะพะฒะตะฝะฝะพะต ะฟะพะดัะฒะตัะถะดะตะฝะธะต)
- **Logging**: DEBUG

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต**: ะััััะฐั ัะฐะทัะฐะฑะพัะบะฐ ะฑะตะท ะฒะฝะตัะฝะธั ะทะฐะฒะธัะธะผะพััะตะน.

### `development-remote` - ะะฐะทัะฐะฑะพัะบะฐ ั ัะดะฐะปัะฝะฝัะผ API
- **Database**: MemoryStorage (in-memory ะบะตั)
- **SMS**: Remote (ัะตัะตะท NMservices API)
- **Payment**: Remote (ัะตัะตะท NMservices API)
- **Logging**: DEBUG

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต**: ะขะตััะธัะพะฒะฐะฝะธะต ะธะฝัะตะณัะฐัะธะธ ั ัะตะฐะปัะฝัะผ backend.

### `staging` - ะขะตััะพะฒะฐั ััะตะดะฐ
- **Database**: MemoryStorage (in-memory ะบะตั)
- **SMS**: Real (Eskiz, test mode)
- **Payment**: Real (Payme, test mode)
- **Logging**: INFO

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต**: ะขะตััะธัะพะฒะฐะฝะธะต ะฟะตัะตะด production.

### `production` - ะะพะตะฒะพะน ัะตะถะธะผ
- **Database**: MemoryStorage (in-memory ะบะตั)
- **SMS**: Real (Eskiz, live mode)
- **Payment**: Real (Payme, live mode)
- **Logging**: WARNING
- **Monitoring**: Sentry ะฒะบะปัััะฝ

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต**: ะะฐะฑะพัะฐ ั ัะตะฐะปัะฝัะผะธ ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ.

---

## ๐ง ะะพะฝัะธะณััะฐัะธั

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั (.env)

```bash
# ะัะฑะพั ะพะบััะถะตะฝะธั
ENV=development-remote

# Debug ัะตะถะธะผ
DEBUG=True

# Telegram Bot
BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz

# Remote API (NMservices)
REMOTE_API_BASE_URL=http://your-backend:8000
REMOTE_API_KEY=your_api_key

# Development ะพะฟัะธะธ
SKIP_REGISTRATION=False  # ะัะพะฟัััะธัั ัะตะณะธัััะฐัะธั ะดะปั ะฑััััะพะณะพ ัะตััะธัะพะฒะฐะฝะธั

# Monitoring (production)
SENTRY_DSN=https://your-sentry-dsn
```

### YAML ะบะพะฝัะธะณััะฐัะธะธ

ะะฐะถะดะพะต ะพะบััะถะตะฝะธะต ะธะผะตะตั ัะฒะพะน YAML ัะฐะนะป ะฒ `config/environments/`:
- ะะฐัะฐะผะตััั ะปะพะณะธัะพะฒะฐะฝะธั
- ะขะธะฟ ััะฐะฝะธะปะธัะฐ ะดะฐะฝะฝัั
- ะะพะฝัะธะณััะฐัะธั ัะตัะฒะธัะพะฒ (SMS, Payment)
- ะะฐัััะพะนะบะธ ะฑะพัะฐ ะธ API

---

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะัะพะฒะตัะบะฐ ะพะบััะถะตะฝะธั

```bash
poetry run python tests/manual/test_env_check.py
```

### ะขะตัั ะฟะพะดะบะปััะตะฝะธั ะบ NMservices API

```bash
poetry run python tests/manual/test_api_connection.py
```

**ะขะตัั ะฟัะพะฒะตััะตั**:
- ะะฐะณััะทะบั ะบะพะฝัะธะณััะฐัะธะธ
- ะะพะดะบะปััะตะฝะธะต ะบ NMservices API
- ะะตะณะธัััะฐัะธั ะฟะพะปัะทะพะฒะฐัะตะปั (`POST /users/register`)
- ะกะพะทะดะฐะฝะธะต ะทะฐะบะฐะทะฐ (`POST /orders`)

### ะะฐะฟััะบ ะฒัะตั ัะตััะพะฒ

```bash
pytest tests/
```

---

## ๐ ะะพะบัะผะตะฝัะฐัะธั

- **[CLAUDE.md](./CLAUDE.md)** - ะะพะปะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั ะดะปั ัะฐะทัะฐะฑะพัะบะธ ั Claude Code
- **[docs/bot_flow.md](./docs/bot_flow.md)** - ะะตัะฐะปัะฝัะน flow ัะฐะฑะพัั ะฑะพัะฐ
- **[docs/DDD_Analysis.md](./docs/DDD_Analysis.md)** - ะะฝะฐะปะธะท DDD ะฐััะธัะตะบัััั
- **[docs/QUICKSTART_DB_TESTING.md](./docs/QUICKSTART_DB_TESTING.md)** - ะัััััะน ััะฐัั ะดะปั ะพัะปะฐะดะบะธ API
- **[docs/TEST_RESULTS.md](./docs/TEST_RESULTS.md)** - ะะตะทัะปััะฐัั ะธะฝัะตะณัะฐัะธะพะฝะฝัั ัะตััะพะฒ

---

## ๐ ะะพะบะฐะปะธะทะฐัะธั

ะะพั ะฟะพะดะดะตัะถะธะฒะฐะตั ััะธ ัะทัะบะฐ:
- ๐ท๐บ ะัััะบะธะน (ru)
- ๐บ๐ฟ ะฃะทะฑะตะบัะบะธะน (uz)
- ๐ฌ๐ง ะะฝะณะปะธะนัะบะธะน (en)

ะัะต ัะตะบััั ััะฐะฝัััั ะฒ `config/localization/messages.yaml`.

---

## ๐๏ธ ะขะตัะฝะพะปะพะณะธัะตัะบะธะน ััะตะบ

- **Python 3.11+**
- **aiogram 3.x** - Telegram Bot Framework
- **httpx** - ะัะธะฝััะพะฝะฝัะน HTTP-ะบะปะธะตะฝั ะดะปั NMservices API
- **pydantic-settings** - ะฃะฟัะฐะฒะปะตะฝะธะต ะบะพะฝัะธะณััะฐัะธะตะน
- **pytest** - ะขะตััะธัะพะฒะฐะฝะธะต
- **Poetry** - ะฃะฟัะฐะฒะปะตะฝะธะต ะทะฐะฒะธัะธะผะพัััะผะธ

---

## ๐ Workflow ัะฐะทัะฐะฑะพัะบะธ

1. **ะกะพะทะดะฐะนัะต feature branch**:
```bash
git checkout -b feature/your-feature-name
```

2. **ะะฝะตัะธัะต ะธะทะผะตะฝะตะฝะธั** ะธ ะฟัะพัะตััะธััะนัะต ะปะพะบะฐะปัะฝะพ

3. **ะะฐะฟัััะธัะต ัะตััั**:
```bash
pytest tests/
```

4. **ะกะพะทะดะฐะนัะต ะบะพะผะผะธั**:
```bash
git add .
git commit -m "feat: your feature description"
```

5. **ะกะพะทะดะฐะนัะต Pull Request** ะฒ `main` branch

---

## ๐ ะะตััะธั

**ะขะตะบััะฐั ะฒะตััะธั**: ัะผะพััะธ ะฒ `pyproject.toml`


---

## ๐ฅ ะะพะฝัะฐะบัั

- **GitHub**: [imchrm/NoMus](https://github.com/imchrm/NoMus)
- **Issues**: [ะกะพะพะฑัะธัั ะพ ะฟัะพะฑะปะตะผะต](https://github.com/imchrm/NoMus/issues)

---

## ๐ ะะธัะตะฝะทะธั

[ะะฝัะพัะผะฐัะธั ะพ ะปะธัะตะฝะทะธะธ]

---

**ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต**: 2026-01-13
